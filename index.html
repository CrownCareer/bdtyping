<!DOCTYPE html><html lang="bn"><head><meta charset="UTF-8"><title>Official Typing Exam System - Final</title><style>
    :root { --blue: #0056b3; --green: #28a745; --red: #dc3545; --bg: #f4f7f6; --teal: #17a2b8; }
    html, body { height: 100%; margin: 0; font-family: 'Segoe UI', Arial, sans-serif; background: var(--bg); overflow-x: hidden; }
    .container { display: flex; flex-direction: column; min-height: 100vh; padding: 20px; box-sizing: border-box; }
    .box { background: #fff; border-radius: 8px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); padding: 20px; margin-bottom: 10px; }
    .hidden { display: none !important; }
    
    /* Auth Styles */
    .auth-card { max-width: 400px; margin: 50px auto; text-align: center; border-top: 5px solid var(--blue); }
    input { width: 100%; padding: 12px; margin: 8px 0; border: 1px solid #ddd; border-radius: 5px; box-sizing: border-box; }
    .btn-main { background: var(--blue); color: white; padding: 12px; border: none; border-radius: 5px; width: 100%; cursor: pointer; font-weight: bold; }

    /* Result Page */
    .result-header { color: #004085; text-align: center; font-size: 24px; margin-bottom: 20px; font-weight: bold; border-bottom: 2px solid #eee; padding-bottom: 10px;}
    .result-grid { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 15px; }
    .card { padding: 12px; border: 1px solid #ddd; background: #fff; border-radius: 8px; font-size: 14px; }
    .card h4 { margin: -12px -12px 10px -12px; padding: 10px; font-size: 15px; border-radius: 8px 8px 0 0; border-bottom: 1px solid #eee; }
    .c-green h4 { color: #28a745; background: #f8fff9; }
    .c-orange h4 { color: #d35400; background: #fffaf0; }
    .c-red h4 { color: #dc3545; background: #fff5f5; }
    .card p { margin: 10px 0; display: flex; justify-content: space-between; border-bottom: 1px dashed #eee; padding-bottom: 5px;}
    .status-banner { background: var(--teal); color: white; text-align: center; padding: 15px; border-radius: 8px; font-size: 22px; font-weight: bold; margin: 20px 0; display: flex; justify-content: center; align-items: center; gap: 20px;}
    .status-tag { background: white; color: var(--green); padding: 5px 25px; border-radius: 5px; }

    /* Exam Page */
    #passage-stable { font-size: 24px; line-height: 1.8; height: 280px; overflow-y: auto; text-align: justify; user-select: none; margin-bottom: 20px; }
    .input-box { border: 2px solid var(--blue); border-radius: 8px; padding: 15px; background: #fff; margin-top: 10px; }
    textarea { width: 100%; height: 110px; font-size: 20px; border: none; outline: none; resize: none; font-family: inherit; }

    /* Admin Table */
    table { width: 100%; border-collapse: collapse; margin-top: 10px; font-size: 13px; }
    th, td { border: 1px solid #ddd; padding: 10px; text-align: left; }
    .edit-btn { background: #f39c12; color: white; border: none; padding: 5px 10px; border-radius: 4px; cursor: pointer; }
    .error-highlight { background-color: #ffcccc; color: #cc0000; text-decoration: underline; }
</style></head><body>

<div class="container">
    <div id="page-login" class="box auth-card">
        <h2 style="color: var(--blue);">‡¶≤‡¶ó‡¶á‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®</h2>
        <input type="text" id="login-user" placeholder="Gmail (‡¶á‡¶â‡¶ú‡¶æ‡¶∞‡¶®‡ßá‡¶Æ)">
        <input type="password" id="login-pass" placeholder="‡¶™‡¶æ‡¶∏‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶°">
        <button class="btn-main" onclick="doLogin()">‡¶≤‡¶ó‡¶á‡¶®</button>
        <p><a href="#" onclick="recoverPass()">‡¶™‡¶æ‡¶∏‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶° ‡¶≠‡ßÅ‡¶≤‡ßá ‡¶ó‡ßá‡¶õ‡ßá‡¶®?</a></p>
        <p>‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü ‡¶®‡ßá‡¶á? <a href="#" onclick="showPage('page-signup')">‡¶∞‡ßá‡¶ú‡¶ø‡¶∏‡ßç‡¶ü‡ßç‡¶∞‡ßá‡¶∂‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®</a></p>
        <hr><button onclick="adminAccess()" style="background:none; border:none; color:silver; cursor:pointer; font-size:10px;">Admin</button>
    </div>

    <div id="page-signup" class="box auth-card hidden">
        <h2 style="color: var(--green);">‡¶∞‡ßá‡¶ú‡¶ø‡¶∏‡ßç‡¶ü‡ßç‡¶∞‡ßá‡¶∂‡¶®</h2>
        <input type="text" id="sign-name" placeholder="‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶®‡¶æ‡¶Æ">
        <input type="text" id="sign-user" placeholder="Gmail (English Only)">
        <input type="password" id="sign-pass" placeholder="‡¶™‡¶æ‡¶∏‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶° (‡¶®‡ßÇ‡¶®‡ßç‡¶Ø‡¶§‡¶Æ ‡ß¨ ‡¶Ö‡¶ï‡ßç‡¶∑‡¶∞)">
        <button class="btn-main" style="background: var(--green);" onclick="doSignup()">‡¶∏‡¶æ‡¶á‡¶® ‡¶Ü‡¶™</button>
        <p><a href="#" onclick="showPage('page-login')">‡¶≤‡¶ó‡¶á‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®</a></p>
    </div>

    <div id="page-exam" class="hidden">
        <div class="box" style="display: flex; justify-content: space-between; align-items: center;">
            <div>üë§ ‡¶®‡¶æ‡¶Æ: <b><span id="display-name"></span></b></div>
            <div style="color: var(--red); font-size: 20px; font-weight: bold;">‡¶∏‡¶Æ‡¶Ø‡¶º: <span id="timer">10:00</span></div>
        </div>
        <div id="passage-stable" class="box"><div id="p-text"></div></div>
        <div class="input-box"><textarea id="t-input" placeholder="Bijoy ‡¶Ö‡¶•‡¶¨‡¶æ Unicode ‡¶Ø‡ßá ‡¶ï‡ßã‡¶®‡ßã ‡¶™‡¶¶‡ßç‡¶ß‡¶§‡¶ø‡¶§‡ßá ‡¶ü‡¶æ‡¶á‡¶™ ‡¶ï‡¶∞‡ßÅ‡¶®..." oninput="startCount()" onpaste="return false;"></textarea></div>
        <div style="text-align: right; margin-top: 15px;"><button class="btn-main" style="width: auto; background: var(--green); padding: 10px 40px;" onclick="finishExam()">Go to Finish</button></div>
    </div>

    <div id="page-result" class="box hidden">
        <div class="result-header">üîç ‡¶ü‡¶æ‡¶á‡¶™‡¶ø‡¶Ç ‡¶´‡¶≤‡¶æ‡¶´‡¶≤ ‡¶ì ‡¶¨‡¶ø‡¶∏‡ßç‡¶§‡¶æ‡¶∞‡¶ø‡¶§</div>
        <div class="result-grid">
            <div class="card c-green">
                <h4>‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ, ‡¶≠‡¶æ‡¶∑‡¶æ, ‡¶∏‡¶Æ‡¶Ø‡¶º</h4>
                <p>üìÖ ‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ: <span id="r-date"></span></p>
                <p>üó£Ô∏è ‡¶≠‡¶æ‡¶∑‡¶æ: bangla</p>
                <p>‚è±Ô∏è ‡¶∏‡¶Æ‡¶Ø‡¶º‡¶ï‡¶æ‡¶≤: 10 Min 0 Sec</p>
            </div>
            <div class="card c-orange">
                <h4>‡¶¶‡¶ï‡ßç‡¶∑‡¶§‡¶æ, ‡¶ó‡¶§‡¶ø, ‡¶ó‡¶£‡¶®‡¶æ</h4>
                <p>üöÄ WPM: <b id="r-wpm">0</b></p>
                <p>üéØ Accuracy: <b id="r-acc">0%</b></p>
                <p>‚å®Ô∏è ‡¶ü‡¶æ‡¶á‡¶™ ‡¶∂‡¶¨‡ßç‡¶¶: <span id="r-words">0</span></p>
                <p style="border:none; color:gray; font-size:11px;">∆í ‡¶ó‡¶£‡¶®‡¶æ: 5 Stroke = 1 Word ‡¶π‡¶ø‡¶∏‡ßá‡¶¨‡ßá</p>
            </div>
            <div class="card c-red">
                <h4>‡¶¨‡¶ø‡¶∂‡ßç‡¶≤‡ßá‡¶∑‡¶£</h4>
                <p>üìä Character: <span id="r-char">0</span></p>
                <p>‚úÖ ‡¶∏‡¶†‡¶ø‡¶ï Character: <span id="r-cor">0</span></p>
                <p>‚ùå ‡¶≠‡ßÅ‡¶≤ ‡¶∂‡¶¨‡ßç‡¶¶: <span id="r-wrong">0</span></p>
                <p>üìâ ‡¶≠‡ßÅ‡¶≤‡ßá‡¶∞ ‡¶π‡¶æ‡¶∞: <span id="r-err">0%</span></p>
            </div>
        </div>
        <div class="status-banner">üåü ‡¶´‡¶≤‡¶æ‡¶´‡¶≤: <div class="status-tag" id="r-status">PASS</div></div>
        
        <div style="margin-top:20px;">
            <div style="font-weight:bold; margin-bottom:5px;">Writing Part (‡¶Ü‡¶™‡¶®‡¶æ‡¶∞):</div>
            <div id="user-compare-text" style="padding:15px; border:1px solid #ddd; background:#f9f9f9; line-height:1.8; font-size:18px; border-radius:5px; margin-bottom:15px;"></div>
            
            <div style="font-weight:bold; margin-bottom:5px;">‡¶Æ‡ßÇ‡¶≤ Passage:</div>
            <div id="original-text-result" style="padding:15px; border:1px solid #ddd; background:#fff; line-height:1.8; font-size:18px; border-radius:5px; color:#444;"></div>
        </div>
        <center><button class="btn-main" style="width: 200px; margin-top:20px;" onclick="location.reload()">‡¶Ü‡¶¨‡¶æ‡¶∞ ‡¶ö‡ßá‡¶∑‡ßç‡¶ü‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®</button></center>
    </div>

    <div id="page-admin" class="box hidden">
        <h2 style="color:var(--blue)">Admin Panel</h2>
        <div class="box">
            <h4>‡¶™‡ßç‡¶Ø‡¶æ‡¶∏‡ßá‡¶ú ‡¶è‡¶°‡¶ø‡¶ü:</h4>
            <textarea id="adm-text" style="height: 60px; width:100%; border:1px solid #ddd;"></textarea><br>
            <button class="btn-main" style="width: auto;" onclick="saveTxt()">Save Passage</button>
            <button class="btn-main" style="width: auto; background:#666;" onclick="changeAdminPass()">Update Admin Pass</button>
        </div>
        <table>
            <thead><tr><th>‡¶®‡¶æ‡¶Æ</th><th>‡¶á‡¶â‡¶ú‡¶æ‡¶∞</th><th>‡¶™‡¶æ‡¶∏‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶°</th><th>‡¶Æ‡ßá‡¶Ø‡¶º‡¶æ‡¶¶</th><th>‡¶∏‡ßç‡¶ü‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶∏</th><th>‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶∂‡¶®</th></tr></thead>
            <tbody id="adm-table"></tbody>
        </table>
        <button class="btn-main" style="background:#666; margin-top:20px; width:auto" onclick="location.reload()">Logout Admin</button>
    </div>
</div>

<script>
    let users = JSON.parse(localStorage.getItem('bcc_final_users')) || [];
    let passage = localStorage.getItem('bcc_final_text') || "‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶ü‡¶æ‡¶á‡¶™‡¶ø‡¶Ç ‡¶™‡ßç‡¶Ø‡¶æ‡¶∏‡ßá‡¶ú‡¶ü‡¶ø ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶∏‡ßá‡¶≠ ‡¶ï‡¶∞‡ßÅ‡¶®...";
    let adminPass = localStorage.getItem('admin_master_pass') || "admin123";
    let timeLeft = 600, timerOn = false, timerInt;

    document.getElementById('p-text').innerText = passage;

    function showPage(id) {
        document.querySelectorAll('.container > div').forEach(d => d.classList.add('hidden'));
        document.getElementById(id).classList.remove('hidden');
    }

    // --- Normalization for Bijoy & Unicode ---
    function normalizeText(str) {
        // This is a placeholder for a complex mapping function. 
        // For a basic typing test, we allow the comparison to match character by character.
        return str.trim();
    }

    function doSignup() {
        const n = document.getElementById('sign-name').value;
        const u = document.getElementById('sign-user').value.toLowerCase().trim();
        const p = document.getElementById('sign-pass').value;
        
        if(!u.endsWith("@gmail.com")) return alert("Only Gmail addresses are allowed!");
        if(!/^[a-z0-9@.]+$/.test(u)) return alert("Username must be English only!");
        if(p.length < 6) return alert("Password min 6 chars!");
        if(!n || !u || !p) return alert("Fill all info!");

        const mockCode = Math.floor(1000 + Math.random() * 9000);
        // Correctly prompt for verification
        setTimeout(() => {
            const userCode = prompt(`Verification Code sent to ${u}: ${mockCode}`);
            if(userCode === mockCode.toString()) {
                let exp = new Date(); exp.setDate(exp.getDate() + 30);
                users.push({name: n, user: u, pass: p, expiry: exp.getTime(), status: 'Active'});
                localStorage.setItem('bcc_final_users', JSON.stringify(users));
                alert("Success!"); showPage('page-login');
            } else {
                alert("Wrong Code!");
            }
        }, 100);
    }

    function doLogin() {
        const u = document.getElementById('login-user').value.toLowerCase().trim();
        const p = document.getElementById('login-pass').value;
        const found = users.find(x => x.user === u && x.pass === p);
        if(found) {
            document.getElementById('display-name').innerText = found.name;
            showPage('page-exam');
        } else alert("Error!");
    }

    function recoverPass() {
        const u = prompt("Enter Gmail:");
        const found = users.find(x => x.user === u?.toLowerCase().trim());
        if(found) alert("Pass: " + found.pass);
    }

    function adminAccess() {
        if(prompt("Admin Pass:") === adminPass) {
            document.getElementById('adm-text').value = passage;
            renderTable();
            showPage('page-admin');
        }
    }

    function renderTable() {
        const tb = document.getElementById('adm-table');
        tb.innerHTML = "";
        users.forEach((u, i) => {
            tb.innerHTML += `<tr><td>${u.name}</td><td>${u.user}</td><td>${u.pass}</td>
                <td>${new Date(u.expiry).toLocaleDateString()}</td><td>${u.status}</td>
                <td><button onclick="editUser(${i})">Edit</button></td></tr>`;
        });
    }

    function editUser(i) {
        let p = prompt("New Pass:", users[i].pass);
        if(p) users[i].pass = p;
        localStorage.setItem('bcc_final_users', JSON.stringify(users));
        renderTable();
    }

    function startCount() {
        if(!timerOn) {
            timerOn = true;
            timerInt = setInterval(() => {
                timeLeft--;
                let m = Math.floor(timeLeft/60), s = timeLeft%60;
                document.getElementById('timer').innerText = `${m}:${s < 10 ? '0' : ''}${s}`;
                if(timeLeft <= 0) finishExam();
            }, 1000);
        }
    }

    function finishExam() {
        clearInterval(timerInt);
        const inp = document.getElementById('t-input').value;
        const pWords = passage.split(/\s+/);
        const iWords = inp.trim().split(/\s+/);
        let corChars = 0, comparisonHTML = "";

        // Support for mixed encoding relies on the user typing the matching glyphs
        pWords.forEach((word, idx) => {
            const userWord = iWords[idx] || "";
            if (userWord === word) {
                comparisonHTML += userWord + " ";
                corChars += word.length;
            } else {
                comparisonHTML += `<span class="error-highlight">${userWord || '___'}</span> `;
            }
        });

        let acc = inp.replace(/\s/g, '').length > 0 ? Math.round((corChars/inp.replace(/\s/g, '').length)*100) : 0;
        let wpm = ((corChars/5)/((600-timeLeft)/60 || 0.1)).toFixed(2);

        document.getElementById('r-date').innerText = new Date().toLocaleDateString();
        document.getElementById('r-wpm').innerText = wpm;
        document.getElementById('r-acc').innerText = acc + "%";
        document.getElementById('r-words').innerText = iWords.filter(w => w).length;
        document.getElementById('r-char').innerText = inp.replace(/\s/g, '').length;
        document.getElementById('r-cor').innerText = corChars;
        document.getElementById('r-wrong').innerText = Math.max(0, iWords.length - (corChars/5));
        document.getElementById('r-err').innerText = (100 - acc) + "%";
        document.getElementById('r-status').innerText = acc >= 90 ? "PASS" : "FAIL";
        document.getElementById('user-compare-text').innerHTML = comparisonHTML;
        document.getElementById('original-text-result').innerText = passage;
        showPage('page-result');
    }

    function saveTxt() {
        localStorage.setItem('bcc_final_text', document.getElementById('adm-text').value);
        location.reload();
    }
</script></body></html>